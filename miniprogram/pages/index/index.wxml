<!-- index.wxml -->
<page-meta page-style="overflow: hidden; {{loading? 'visibility: hidden;': ''}}" >
  <navigation-bar back="{{false}}" extClass="transparent" color="black" background="#FFF" style="text-align: center;">
    <view slot="left">
      <view class="loc-area">
        <loc-select3
          locStyle="margin: 0 40rpx;"
          pannelStyle="padding: 30rpx 20rpx; margin-top: 24rpx; "
          selectedId="{{curCityId}}"
          selectedName="{{cityName}}"
          list="{{cityList}}"
          bindCityChange="handleCityChange"
          bindClickReLoc="handleClickReLoc"
          bindCityPannelOpenStateChange="handleCityPannelOpenStateChange"
        />
      </view>
    </view>
  </navigation-bar>

  <view class="index-page">
    <!-- 地图区域 70% -->
    <view class="map-area">
      <map
        class="map-container"
        latitude="{{latitude}}"
        longitude="{{longitude}}"
        scale="{{scale}}"
        markers="{{markers}}"
        show-location="{{showLocation}}"
        enable-scroll="{{true}}"
        enable-zoom="{{true}}"
        enable-rotate="{{false}}"
        bindmarkertap="handleMarkerTap"
      />
    </view>

    <!-- 种植信息卡片区域 30% -->
    <view class="card-area">
      <view class="card" wx:if="{{selectedPlanting}}">
        <view class="card-emoji">{{selectedPlanting.emoji}}</view>
        <view class="card-info">
          <view class="card-name">{{selectedPlanting.name}}</view>
          <view class="card-grower">种植者: {{selectedPlanting.grower}}</view>
          <view class="card-distance">距离: {{selectedPlanting.distance}}</view>
        </view>
      </view>
      <view class="card card-empty" wx:else>
        <view class="card-empty-text">点击地图上的标记查看种植信息</view>
      </view>
    </view>
  </view>

  <view>
    <custom-tab-bar></custom-tab-bar>
  </view>

</page-meta>
