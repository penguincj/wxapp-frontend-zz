<!-- index.wxml -->
<page-meta page-style="overflow: hidden;">
  <navigation-bar 
    back="{{true}}" 
    extClass="transparent" 
    styleType="dark" 
    color="black" 
    background="#FFF"
  ></navigation-bar>

  <view class="page-customize-explanation">
    <image src="/static/images/bubble-bg.webp" class="bg-image" mode="widthFix"></image>
    
    <!-- 主标题区域 -->
    <view class="title-section">
      <view class="main-title {{isCompleted ? 'completed-title' : ''}}">
        {{isCompleted ? titleConfig.completed.mainTitle : titleConfig.loading.mainTitle}}
      </view>
      <view class="subtitle {{isCompleted ? 'completed-subtitle' : ''}}">
        {{isCompleted ? titleConfig.completed.subtitle : titleConfig.loading.subtitle}}
      </view>
    </view>
    
    <!-- 气泡元素区域 -->
    <view class="bubble-section" wx:if="{{!isCompleted}}">
      <block wx:for="{{bubbles}}" wx:key="id">
        <view 
          class="bubble {{item.type === 'clear' ? 'clear-bubble' : 'blur-bubble'}}"
          style="top: {{item.top}}rpx; left: {{item.left}}rpx; opacity: {{item.opacity}}; filter: blur({{item.blurAmount}}rpx); animation-duration: {{item.animationDuration}}s; --bubble-scale: {{item.scale}};"
          data-id="{{item.id}}"
          bindtap="onBubbleClick"
        >
          {{item.text}}
        </view>
      </block>
    </view>
    <view class="result-section" wx:if="{{isCompleted}}">
      <card-list list="{{narrationList}}"></card-list>
      <view class="btn-group">
        <view class="btn-item {{narrationList.length > 1 ? 'btn1' : ''}}">
          <view class="btn-text">再选选</view>
        </view>
        <view class="btn-item btn2" wx:if="{{narrationList.length === 1}}">
          <view class="btn-text">听讲解</view>
        </view>
      </view>
    </view>
  </view>
</page-meta>
